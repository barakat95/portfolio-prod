import{g as O,k as j}from"./chunk-KDPZAZLD.js";import{Ab as N,Eb as B,Ga as S,Ja as T,Ka as s,Oa as E,Ta as P,Xa as L,Y as f,Z as b,cb as y,db as W,eb as v,ec as F,gb as d,ib as x,jb as m,ka as c,kb as u,lb as o,mb as n,nb as g,ob as _,pb as h,pc as M,qb as k,rb as I,ub as V,vb as H,wb as A,yb as p,zb as w}from"./chunk-JNSPHHAG.js";var $=["worksSection"],Q=t=>["/works",t],D=(t,a)=>a._id;function Y(t,a){if(t&1){let e=_();o(0,"span",12),h("click",function(){let r=f(e).$implicit,l=k();return b(l.filterByTag(r))}),p(1),n()}if(t&2){let e=a.$implicit;s(),w(e)}}function q(t,a){if(t&1&&(o(0,"div",22),p(1),n()),t&2){let e=a.$implicit;s(),N(" ",e," ")}}function z(t,a){if(t&1&&(o(0,"div",13),g(1,"span",14)(2,"span",15)(3,"span",16)(4,"span",17),o(5,"div",18),g(6,"img",19),n(),o(7,"div",20)(8,"div",21),m(9,q,2,1,"div",22,x),n()(),o(11,"p",23),p(12),n()()),t&2){let e=a.$implicit,i=k();v("visible",i.isVisible),y("routerLink",B(6,Q,e._id)),s(6),I("alt",e.title),y("src",e.coverImage,S),s(3),u(e.tags),s(3),w(e.title)}}function R(t,a){t&1&&(o(0,"div",9),g(1,"div",24),n())}function U(t,a){t&1&&(o(0,"div",10)(1,"p",25),p(2,"No more albums to load"),n()())}function G(t,a){t&1&&(o(0,"div",11)(1,"p",26),p(2,"No albums found"),n()())}var oe=(()=>{class t{constructor(e){this.apiService=e,this.isVisible=!1,this.albums=c([]),this.albumsResponse=c(null),this.page=c(1),this.limit=c(10),this.isLoading=c(!1),this.hasNextPage=c(!1),this.tags=c([])}ngOnInit(){this.setupIntersectionObserver(),this.getAlbums(),this.getTags()}setupIntersectionObserver(){new IntersectionObserver(i=>{i.forEach(r=>{r.isIntersecting&&(this.isVisible=!0)})},{threshold:.3}).observe(this.worksSection.nativeElement)}getAlbums(){this.isLoading()||(this.isLoading.set(!0),this.apiService.getAlbums(this.limit(),this.page()).subscribe({next:e=>{this.albumsResponse.set(e),this.hasNextPage.set(e.hasNextPage),this.page()===1?this.albums.set(e.albums):this.albums.set([...this.albums(),...e.albums]),this.isLoading.set(!1)},error:e=>{console.error("Error loading albums:",e),this.isLoading.set(!1)}}))}onScroll(e){let i=document.documentElement.scrollTop||document.body.scrollTop,r=document.documentElement.scrollHeight||document.body.scrollHeight,l=document.documentElement.clientHeight||window.innerHeight;i+l>=r-1e3&&this.hasNextPage()&&!this.isLoading()&&(this.page.set(this.page()+1),this.getAlbums())}getTags(){this.apiService.getTags().subscribe(e=>{this.tags.set(e)})}filterByTag(e){this.apiService.getAlbums(this.limit(),this.page(),[e]).subscribe(i=>{this.albumsResponse.set(i),this.albums.set(i.albums),this.hasNextPage.set(i.hasNextPage)})}resetPagination(){this.page.set(1),this.albums.set([]),this.getAlbums()}static{this.\u0275fac=function(i){return new(i||t)(E(M))}}static{this.\u0275cmp=P({type:t,selectors:[["app-works"]],viewQuery:function(i,r){if(i&1&&V($,7),i&2){let l;H(l=A())&&(r.worksSection=l.first)}},hostBindings:function(i,r){i&1&&h("scroll",function(C){return r.onScroll(C)},!1,T)},decls:17,vars:7,consts:[["worksSection",""],[1,"min-h-[60vh]","flex","items-center","justify-center","px-4"],[1,"text-6xl","xl:text-[10rem]","fade-in"],[1,"mb-16","px-2"],[1,"flex","items-center","justify-center","gap-2","mb-16","flex-wrap"],[1,"uppercase","bg-gray-dark","text-gray-light","px-2","py-1","rounded-full","text-sm","cursor-pointer",3,"click"],[1,"uppercase","whitespace-nowrap","bg-gray-dark","text-gray-light","px-2","py-1","rounded-full","text-sm","cursor-pointer"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4"],[1,"cursor-pointer","relative","group","p-4","fade-in",3,"routerLink","visible"],[1,"flex","justify-center","items-center","py-8"],[1,"text-center","py-8"],[1,"text-center","py-16"],[1,"uppercase","whitespace-nowrap","bg-gray-dark","text-gray-light","px-2","py-1","rounded-full","text-sm","cursor-pointer",3,"click"],[1,"cursor-pointer","relative","group","p-4","fade-in",3,"routerLink"],[1,"absolute","top-0","left-0","w-12","h-12","border-t-1","border-l-1","border-secondary","opacity-0","group-hover:opacity-100","transition-opacity","duration-300"],[1,"absolute","top-0","right-0","w-12","h-12","border-t-1","border-r-1","border-secondary","opacity-0","group-hover:opacity-100","transition-opacity","duration-300"],[1,"absolute","bottom-0","left-0","w-12","h-12","border-b-1","border-l-1","border-secondary","opacity-0","group-hover:opacity-100","transition-opacity","duration-300"],[1,"absolute","bottom-0","right-0","w-12","h-12","border-b-1","border-r-1","border-secondary","opacity-0","group-hover:opacity-100","transition-opacity","duration-300"],[1,"aspect-[16/7]","overflow-hidden","mb-2"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"flex","text-white","gap-2","mb-2"],[1,"text-gray-300","py-1","rounded-full","w-fit","text-sm","uppercase","flex","items-center","gap-2"],[1,"bg-gray-dark","text-gray-300","py-1","px-2","gap-4","rounded-full","text-sm","uppercase","flex","items-center","justify-center"],[1,"text-3xl","text-secondary"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-secondary"],[1,"text-gray-400"],[1,"text-gray-400","text-xl"]],template:function(i,r){if(i&1){let l=_();o(0,"div",null,0)(2,"header",1)(3,"h1",2),p(4," Albums "),n()(),o(5,"section",3)(6,"div",4)(7,"span",5),h("click",function(){return f(l),b(r.resetPagination())}),p(8,"All"),n(),m(9,Y,2,1,"span",6,x),n(),o(11,"div",7),m(12,z,13,8,"div",8,D),n(),L(14,R,2,0,"div",9)(15,U,3,0,"div",10)(16,G,3,0,"div",11),n()()}i&2&&(s(3),W("transition-delay","0.8s"),v("visible",r.isVisible),s(6),u(r.tags()),s(3),u(r.albums()),s(2),d(r.isLoading()?14:-1),s(),d(!r.hasNextPage()&&!r.isLoading()&&r.albums().length>0?15:-1),s(),d(r.albums().length===0&&!r.isLoading()?16:-1))},dependencies:[F,j,O],styles:["h1[_ngcontent-%COMP%]{font-family:ClashDisplay-Variable}.fade-in[_ngcontent-%COMP%]{opacity:0;transform:translateY(30px);transition:all .8s ease}.fade-in.visible[_ngcontent-%COMP%]{opacity:1;transform:translateY(0);transition-delay:2s}"]})}}return t})();export{oe as WorksComponent};
